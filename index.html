<!doctype html>
<html>
<head>
<title>24 hours clock (dev)</title>

<style type='text/css'>
/*
 * canvas {width: 800px; height: 800px; border: 1px solid red;}
 */
</style>

</head>

<body>
<div>
	<input size='8' id='latitude' name='latitude' value='50.0000' /> <select name='latitude-hemisphere'>
		<option value='N' selected='selected'>N</option>
		<option value='S'>S</option>
	</select><br />
	<input size='8' id='longitude' name='longitude' value='36.0000' /> <select name='longitude-hemisphere'>
		<option selected='selected' value='E'>E</option>
		<option value='W'>W</option>
	</select><br />
	
</div>
<canvas id='canvas' width='800' height='800'>Canvas</canvas>

<div id='log'></div>
<nav id='controls'>
	<button id='update-clock'>Update</button>
</nav>

<script type='text/javascript'>

var ClockClass = function(longitude, latitude, time) {
	this.longitude=longitude;
	this.latitude=latitude;
	this.time=new Date(time);
	this.canvasElement=document.getElementById('canvas');
	this.canvas=this.canvasElement.getContext("2d");
	this.centerPoint=[];
	this.centerPoint[0]=this.canvasElement.width/2;
	this.centerPoint[1]=this.canvasElement.height/2;
	var pointerLength = {
		hour: 200,
		minute: 250,
	};
	var pointerWidth = {
		hour: 8,
		minute:2
	}

	this.getSunrise=function() {
		//FIXME: sunrise must be calculated using longitude and latitude
		var sunrise=new Date();
		sunrise.setHours(6,43);
		return sunrise;
	}
	this.getSunset=function() {
		//FIXME: sunset must be calculated
		var sunset=new Date();
		sunset.setHours(15,55);
		return sunset;
	}
	
	this.hourDegree=function(time) {
		//alert ('type of time is '+typeof (time));
		//if (typeof (time) != )
		var minutes=time.getHours()*60+time.getMinutes();
		//degree = minutes / (24*60) / 360
		var degree=minutes/4;
		return degree;		
	}
	
	this.minuteDegree=function(time) {
		var seconds=time.getMinutes()*60+time.getSeconds();
		var degree=seconds/10;
		return degree;
	}
	
	this.renderBody=function() {
		this.canvas.beginPath();
		this.canvas.lineWidth=1;
		this.canvas.arc(400,400,300,0,2*Math.PI);
		this.canvas.stroke();
	}
	
	this.renderPointers=function() {
		var hourDegree=this.hourDegree(time);
		var rad=hourDegree/180*Math.PI;
		var targetX=this.centerPoint[0]+pointerLength.hour*Math.sin(rad);
		var targetY=this.centerPoint[1]-pointerLength.hour*Math.cos(rad);
		
		this.canvas.beginPath();
		this.canvas.moveTo(this.centerPoint[0],this.centerPoint[1]);
		this.canvas.lineWidth=8;
		this.canvas.lineTo(targetX,targetY);
		
		rad=this.minuteDegree(time)/180*Math.PI;
		targetX=this.centerPoint[0]+pointerLength.minute*Math.sin(rad);
		targetY=this.centerPoint[1]-pointerLength.minute*Math.cos(rad);
		this.canvas.moveTo(this.centerPoint[0],this.centerPoint[1]);
		this.canvas.lineTo(targetX,targetY);
		
		this.canvas.stroke();
	}
	
	this.render=function() {
		console.log('Clock: render()');
		this.renderBody();
		this.renderPointers();		
	}
	
	this.update=function() {
		console.log('Clock: update()');
		this.canvas.clearRect(0,0, this.canvasElement.width, this.canvasElement.height);
		this.time=new Date();
		this.render();
	}
	
	
};

var date=new Date();
var clock = new ClockClass(50,36,date);
clock.render();



document.getElementById('update-clock').addEventListener('click',function() {
	clock.update()
	});




console.log(canvas);
console.log(clock);
console.log(clock.getSunrise());
console.log(clock.getSunset());




</script>

</body>
</html>

